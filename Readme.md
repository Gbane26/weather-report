# Weather Report App üå¶Ô∏è

Cette application permet de soumettre et de consulter des rapports m√©t√©o en fonction de la localisation g√©ographique. Elle utilise **Spring** pour le backend, **Tomcat** comme serveur d'application et **Oracle Database** pour le stockage des donn√©es.

## Fonctionnalit√©s
- **Soumettre un rapport m√©t√©o** : Enregistrer un rapport avec la latitude, la longitude, la condition m√©t√©o et la temp√©rature.
- **Consulter tous les rapports** : Visualiser tous les rapports m√©t√©orologiques enregistr√©s dans une table.
- **Rechercher des rapports proches** : Effectuer une recherche de rapports en fonction de la latitude, la longitude et un rayon sp√©cifi√© autour de cette position.

## Pr√©requis

Avant de commencer, assurez-vous que vous avez les √©l√©ments suivants install√©s sur votre machine :

### Backend (Spring avec Tomcat)

- **Java 11+** (pour faire tourner le backend bas√© sur Spring Boot)
- **Maven** (pour la gestion des d√©pendances et la construction du projet)
- **Tomcat 9+** (si vous d√©ployez l'application sur un serveur Tomcat local ou distant)
- **Oracle Database 19c ou sup√©rieur** (pour la gestion des donn√©es)

### Frontend

- **Node.js et npm** (pour la gestion de l'interface utilisateur avec des outils comme Bootstrap et fetch API)
- **Navigateur web** pour visualiser l'interface.

## Installation

### 1. Installation de Tomcat

1. T√©l√©chargez Tomcat depuis le site officiel [Apache Tomcat](https://tomcat.apache.org/download-90.cgi).
2. D√©compressez le fichier t√©l√©charg√© dans un r√©pertoire de votre choix.
3. D√©marrez Tomcat en ex√©cutant `bin/startup.sh` (Linux/macOS) ou `bin/startup.bat` (Windows).

Tomcat sera alors accessible via `http://localhost:8080`.

### 2. Configuration de la Base de Donn√©es Oracle

Avant d'ex√©cuter l'application, assurez-vous que vous avez une base de donn√©es Oracle fonctionnelle.

1. **Cr√©er une base de donn√©es et un utilisateur Oracle** :
    - Cr√©ez une base de donn√©es Oracle si elle n'existe pas d√©j√†.
    - Cr√©ez un utilisateur dans la base de donn√©es avec les privil√®ges n√©cessaires.

    Exemple de script SQL pour cr√©er un utilisateur :
    ```sql
    CREATE USER weather_user IDENTIFIED BY your_password;
    GRANT CONNECT, RESOURCE TO weather_user;
    ```

2. **Cr√©er la table pour stocker les rapports m√©t√©o** :
    Voici une structure de table simple pour stocker les rapports m√©t√©o :

    ```sql
    CREATE TABLE weather_reports (
        id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        latitude NUMBER(10, 6) NOT NULL,
        longitude NUMBER(10, 6) NOT NULL,
        condition VARCHAR2(255) NOT NULL,
        temperature NUMBER(5, 2) NOT NULL,
        timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    );
    ```

3. **Configurer la connexion √† la base de donn√©es dans le projet** :
    - Ouvrez le fichier `src/main/resources/application.properties`.
    - Modifiez les propri√©t√©s de connexion √† la base de donn√©es Oracle :

    ```properties
    spring.datasource.url=jdbc:oracle:thin:@localhost:1521:xe
    spring.datasource.username=weather_user
    spring.datasource.password=your_password
    spring.datasource.driver-class-name=oracle.jdbc.OracleDriver
    spring.jpa.database-platform=org.hibernate.dialect.Oracle12cDialect
    spring.jpa.hibernate.ddl-auto=update
    ```

    Assurez-vous que le service Oracle fonctionne sur le port `1521` et que vous avez bien renseign√© l'utilisateur et le mot de passe.

### 3. Installation du Backend avec Maven

1. Clonez le d√©p√¥t du projet :
    ```bash
    git clone https://github.com/Gbane26/weather-report.git
    cd weather-report
    ```

2. Installez les d√©pendances avec Maven :
    ```bash
    mvn install
    ```

3. Cr√©ez un fichier WAR (pour d√©ployer sur Tomcat) :
    ```bash
    mvn clean package
    ```

    Cela va g√©n√©rer un fichier `weather-report.war` dans le r√©pertoire `target/`.

### 4. D√©ploiement sur Tomcat

1. Copiez le fichier `weather-report.war` g√©n√©r√© dans le r√©pertoire `webapps/` de votre installation Tomcat.

2. Red√©marrez Tomcat en ex√©cutant `bin/shutdown.sh` puis `bin/startup.sh` (ou `shutdown.bat` et `startup.bat` sous Windows).

3. L'application sera alors accessible via `http://localhost:8080/weather-report`.

### 5. Installation du Frontend (Interface Web)

Le frontend est constitu√© d'un fichier `index.jsp` dans le r√©pertoire `src/main/webapp/`. Il utilise **Bootstrap 5** et **JavaScript** pour l'interaction avec le backend.

- Le fichier `index.jsp` est d√©j√† int√©gr√© dans le projet, il n'y a donc pas de configuration suppl√©mentaire √† effectuer pour l'affichage de l'interface web.

### 6. Lancer l'application

Apr√®s avoir d√©ploy√© l'application sur Tomcat, vous pouvez acc√©der √† l'interface web √† l'adresse suivante dans votre navigateur : `http://localhost:8080/weather-report`



## Utilisation

1. **Soumettre un rapport m√©t√©o** :  
   - Entrez la latitude, la longitude, la condition m√©t√©o (ex. : "ensoleill√©") et la temp√©rature dans le formulaire sous "Soumettre un rapport m√©t√©o".
   - Cliquez sur "Soumettre" pour enregistrer le rapport dans la base de donn√©es.

2. **Rechercher des rapports proches** :  
   - Entrez la latitude, la longitude et le rayon en kilom√®tres dans le formulaire "Rechercher des rapports m√©t√©o proches".
   - Cliquez sur "Rechercher" pour obtenir les rapports situ√©s dans le rayon sp√©cifi√©.

3. **Visualiser tous les rapports** :  
   - Tous les rapports soumis sont affich√©s dans une table, avec les informations de latitude, longitude, condition m√©t√©o, temp√©rature et horodatage.

## API

### 1. **POST /weather-report/api/weather/report**
Soumet un nouveau rapport m√©t√©o.

**Param√®tres** :
- `latitude` : Latitude du rapport (type `Double`)
- `longitude` : Longitude du rapport (type `Double`)
- `condition` : Condition m√©t√©orologique (type `String`)
- `temperature` : Temp√©rature en ¬∞C (type `Double`)

**Exemple de requ√™te** :
```json
{
    "latitude": 42.5,
    "longitude": -70.0,
    "condition": "Ensoleill√©",
    "temperature": 25.5
}
```

### 2. **GET /weather-report/api/weather/all**
R√©cup√®re tous les rapports m√©t√©o enregistr√©s.

**Exemple de requ√™te** :
```bash
GET /weather-report/api/weather/all
```
**Exemple de reponse** :
```json
[
    {
        "latitude": 42.5,
        "longitude": -70.0,
        "condition": "Ensoleill√©",
        "temperature": 25.5,
        "timestamp": "2025-04-18T00:00:00Z"
    },
    {
        "latitude": 43.5,
        "longitude": -71.0,
        "condition": "Pluvieux",
        "temperature": 18.0,
        "timestamp": "2025-04-18T01:00:00Z"
    }
]
```

### 3. **GET /weather-report/api/weather/nearby**
R√©cup√®re les rapports m√©t√©o proches d'un point donn√© (latitude, longitude) dans un rayon sp√©cifi√©.

**Param√®tres** :
- `lat` : Latitude (type `Double`)
- `lon` : Longitude (type `Double`)
- `radiusKm` : Rayon en kilom√®tres (type `Double`)

**Exemple de requ√™te** :
```bash
GET /weather-report/api/weather/nearby?lat=42.5&lon=-70.0&radiusKm=50
```
**Exemple de reponse** :
```json
[
    {
        "latitude": 42.7,
        "longitude": -70.2,
        "condition": "Nuageux",
        "temperature": 22.0,
        "timestamp": "2025-04-18T00:30:00Z"
    }
]
```
## Probl√®mes connus
- Les rapports m√©t√©orologiques peuvent ne pas √™tre actualis√©s imm√©diatement apr√®s la soumission si la page n'est pas rafra√Æchie.

- Le syst√®me de recherche peut ne pas toujours donner des r√©sultats si les coordonn√©es sont mal sp√©cifi√©es ou si le rayon est trop grand.